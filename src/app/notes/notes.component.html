<div class="notes-container">
  <form [formGroup]="form" (ngSubmit)="addOrUpdateNote()" class="note-form">
    <mat-form-field class="full-width">
      <input matInput placeholder="Título" formControlName="title" />
    </mat-form-field>

    <mat-form-field class="full-width">
      <textarea matInput placeholder="Contenido" formControlName="content"></textarea>
    </mat-form-field>

    <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || saving">
      {{ editMode ? 'Actualizar' : 'Agregar' }}
    </button>
    <button *ngIf="editMode" mat-button color="warn" type="button" (click)="cancelEdit()">
      Cancelar
    </button>
  </form>

  <!-- Filtros estilo WhatsApp -->
  <mat-button-toggle-group [(ngModel)]="filter" aria-label="Filtro">
    <mat-button-toggle value="all">Todas</mat-button-toggle>
    <mat-button-toggle value="new">Nuevas</mat-button-toggle>
    <mat-button-toggle value="completed">Completadas</mat-button-toggle>
  </mat-button-toggle-group>

  <!-- Lista de notas -->
  <mat-card *ngFor="let note of (notes | noteFilter:filter)" class="note-card">
    <mat-card-title>{{ note.title }}</mat-card-title>
    <mat-card-subtitle>
      {{ note.createdAt?.toDate ? (note.createdAt.toDate() | date:'short') : '' }}
    </mat-card-subtitle>
    <mat-card-content>{{ note.content }}</mat-card-content>

    <mat-card-actions>
      <button mat-button color="primary" (click)="editNote(note)" [disabled]="note.status === 'completed'">Editar</button>
      <button mat-button color="warn" (click)="deleteNote(note.id)" [disabled]="note.status === 'completed'">Eliminar</button>
      <button mat-button color="accent" (click)="updateStatus(note.id, 'completed')" [disabled]="note.status === 'completed'">Completar</button>
    </mat-card-actions>
  </mat-card>

  <!-- Botones exportación -->
  <div class="export-buttons">
    <button mat-raised-button color="primary" (click)="exportToPDF(notes)">Exportar PDF</button>
    <button mat-raised-button color="accent" (click)="exportToExcel(notes)">Exportar Excel</button>
  </div>
</div>

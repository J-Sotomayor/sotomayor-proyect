<mat-card class="admin-card">
  <mat-card-title>ðŸ‘¤ Panel de AdministraciÃ³n</mat-card-title>
  <mat-card-subtitle>Gestiona usuarios, roles y contraseÃ±as</mat-card-subtitle>

  <div class="table-container">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z4">

      <!-- Nombre -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Nombre </th>
        <td mat-cell *matCellDef="let user"> {{ user.displayName || 'Sin nombre' }} </td>
      </ng-container>

      <!-- Email -->
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef> Email </th>
        <td mat-cell *matCellDef="let user"> {{ user.email }} </td>
      </ng-container>

      <!-- Rol -->
      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef> Rol </th>
        <td mat-cell *matCellDef="let user">
          <mat-chip [color]="user.role === 'admin' ? 'primary' : 'accent'" selected>
            {{ user.role | uppercase }}
          </mat-chip>
        </td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Estado </th>
        <td mat-cell *matCellDef="let user">
          <mat-chip [color]="user.blocked ? 'warn' : 'primary'" selected>
            {{ user.blocked ? 'Bloqueado' : 'Activo' }}
          </mat-chip>
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Acciones </th>
        <td mat-cell *matCellDef="let user">
          <button mat-icon-button color="primary" matTooltip="Hacer Admin" (click)="makeAdmin(user.id)">
            <mat-icon>security</mat-icon>
          </button>
          <button mat-icon-button color="accent" matTooltip="Hacer Usuario" (click)="makeUser(user.id)">
            <mat-icon>person</mat-icon>
          </button>
          <button mat-icon-button color="warn" matTooltip="Bloquear/Desbloquear"
                  (click)="toggleBlock(user.id, user.blocked)">
            <mat-icon>{{ user.blocked ? 'lock_open' : 'lock' }}</mat-icon>
          </button>
          <button mat-icon-button color="primary" matTooltip="Resetear ContraseÃ±a"
                  (click)="resetPassword(user.email)">
            <mat-icon>vpn_key</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</mat-card>
